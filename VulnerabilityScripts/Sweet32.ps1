$RegFileUrl = "http://static.desktopservice.eu/downloads/Source/Software/Sweet32.reg"

## Backup Registry ##
New-Item "C:\source\" -Name "Registry-Backup" -itemtype container
reg Export HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL "C:\source\Registry-Backup\Pre-Sweet32-Changes.reg" /y

## Download and apply Reg File ##
$TestBackup = Test-Path "C:\source\Registry-Backup\Pre-Sweet32-Changes.reg" -PathType Leaf
if ($TestBackup) {
    Invoke-WebRequest -uri $RegFileUrl -outfile $Env:temp\Sweet32.reg
    reg import $Env:Temp\Sweet32.reg
    Return "Registry was backed up and changes were made successfully."
} ELSE {
    throw "Could not find backup! No changes were made."
}
